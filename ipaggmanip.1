.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "IPAGGMANIP 1"
.TH IPAGGMANIP 1 "2014-05-02" "Version 1.86" " "
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
ipaggmanip \- manipulate aggregate statistics, often of network traffic
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
ipaggmanip [transformation options...] [\fIfile\fR] > \fIoutput\fR
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The \fBipaggmanip\fR program reads an aggregate file summarizing \s-1IP\s0 trace data
(or other data), transforms that file or calculates one of its statistics,
and writes the result to standard output.  Aggregate files use the format
produced by \fIipaggcreate\fR\|(1), and can be text or binary.
.PP
An aggregate file consists of pairs of \fIlabels\fR and \fIcounts\fR.  The
resulting dataset is modeled either as a partial function mapping labels to
counts, or as a multiset of labels.  Elements of the multiset are called
\&\*(L"packets\*(R" for convenience, although counts need not correspond to network
packets.  For example, the \fB\-\-sample\fR option is described as sampling
\&\*(L"packets\*(R"; this means that the aggregate file is treated as a multiset of
labels, and each element of the multiset is dropped with a uniform
probability.  When an option refers explicitly to a \*(L"label\*(R", the partial
function representation is assumed.  Thus, the \fB\-\-num\-labels\fR option
reports the number of labels.  This is the same as the number of labels
whose count is greater than 0, since labels with 0 counts are left out of
the partial function.
.PP
Several options refer to "\fIp\fR\-aggregates".  A \fIp\fR\-aggregate consists of a
set of labels whose high-order \fIp\fR bits are the same.  Labels are 32 bits
long, so a 32\-aggregate is the same as a label.  Consider an aggregate file
with the following data:
.PP
.Vb 3
\&  0 3
\&  1 2
\&  2 1
.Ve
.PP
This file contains two 31\-aggregates, as follows:
.PP
.Vb 2
\&  0 5    # combines labels 0 and 1
\&  2 1    # only label 2
.Ve
.PP
A \fIp\fR\-aggregate label has the lower 32\-\fIp\fR bits set to zero.
.SH "OPTIONS"
.IX Header "OPTIONS"
.SS "Transformations"
.IX Subsection "Transformations"
Transformation options change an aggregate file into another aggregate
file.  You may supply several transformation options; they are applied in
order.  Thus, for example, `ipaggmanip \fB\-\-prefix\fR 16 \fB\-\-posterize\fR' will
read an aggregate file, aggregate to prefix level 16, and then replace all
nonzero counts with 1.  This has the same effect as `ipaggmanip \fB\-\-prefix\fR
16 | ipaggmanip \fB\-\-posterize\fR'.
.IP "\fB\-\-prefix\fR \fIp\fR, \fB\-p\fR \fIp\fR" 4
.IX Item "--prefix p, -p p"
Aggregates to prefix level \fIp\fR.  That is, replaces each label with its
\&\fIp\fR\-aggregate's label and outputs the result.  The counts from any labels
in the same aggregate are combined.
.IP "\fB\-\-posterize\fR, \fB\-P\fR" 4
.IX Item "--posterize, -P"
Replaces each label's (nonzero) count with 1.
.IP "\fB\-\-sample\fR \fIn\fR" 4
.IX Item "--sample n"
Sample packets with uniform random probability 1/\fIn\fR.  The output will
have roughly \fIn\fR times fewer packets compared with the input.
.IP "\fB\-\-cull\fR \fIn\fR" 4
.IX Item "--cull n"
Reduce the input to at most \fIn\fR packets by randomly sampling packets.
Input aggregates with no more than \fIn\fR packets are output unchanged.
.IP "\fB\-\-cull\-labels\fR \fIn\fR" 4
.IX Item "--cull-labels n"
Reduce the input to at most \fIn\fR labels by randomly sampling labels.  Input
aggregates with \fIn\fR or fewer labels are output unchanged.  If a label is
included in the output, then its count is the same as in the input.
.IP "\fB\-\-cull\-labels\-by\-packets\fR \fIn\fR" 4
.IX Item "--cull-labels-by-packets n"
Reduce the input to at most \fIn\fR labels by randomly sampling \fIpackets\fR.
That is, throw away packets one at a time until the aggregate has at most
\&\fIn\fR labels.  Input aggregates with \fIn\fR or fewer labels are output
unchanged.  Labels included in the output may have lower counts than in the
input because of the packet sampling.
.IP "\fB\-\-cut\-smaller\fR \fIn\fR" 4
.IX Item "--cut-smaller n"
Drop labels with count less than \fIn\fR.  Other labels are left unchanged.
.IP "\fB\-\-cut\-larger\fR \fIn\fR" 4
.IX Item "--cut-larger n"
Drop labels with count greater than or equal to \fIn\fR.
.IP "\fB\-\-cut\-smaller\-aggregates\fR \fIp\fR,\fIn\fR" 4
.IX Item "--cut-smaller-aggregates p,n"
Drop all labels whose containing \fIp\fR\-aggregates contain less than \fIn\fR
packets.  For instance, given this input:
.Sp
.Vb 4
\&  0 1
\&  1 3
\&  2 1
\&  3 1
.Ve
.Sp
the `\fB\-\-cut\-smaller\-aggregates\fR 31,3' option would produce:
.Sp
.Vb 2
\&  0 1
\&  1 3
.Ve
.Sp
Labels 2 and 3 have been dropped because their shared 31\-aggregate contains
only 2 packets.
.IP "\fB\-\-cut\-larger\-aggregates\fR \fIp\fR,\fIn\fR" 4
.IX Item "--cut-larger-aggregates p,n"
Drop all labels whose containing \fIp\fR\-aggregates contain greater than or
equal to \fIn\fR packets.
.IP "\fB\-\-cut\-smaller\-label\-aggregates\fR \fIp\fR,\fIn\fR" 4
.IX Item "--cut-smaller-label-aggregates p,n"
Drop all labels whose containing \fIp\fR\-aggregates contain greater than or
equal to \fIn\fR labels.  For instance, given this input:
.Sp
.Vb 5
\&  0 1
\&  1 1
\&  2 1
\&  4 1
\&  5 1
.Ve
.Sp
the `\fB\-\-cut\-smaller\-label\-aggregates\fR 30,3' option would produce:
.Sp
.Vb 3
\&  0 1
\&  1 1
\&  2 1
.Ve
.Sp
Labels 4 and 5 have been dropped because their shared 30\-aggregate contains
only 2 labels.
.IP "\fB\-\-cut\-larger\-label\-aggregates\fR \fIp\fR,\fIn\fR" 4
.IX Item "--cut-larger-label-aggregates p,n"
Drop all labels whose containing \fIp\fR\-aggregates contain greater than or
equal to \fIn\fR labels.
.IP "\fB\-\-fake\-by\-discriminating\-prefixes\fR[=\fItype\fR]" 4
.IX Item "--fake-by-discriminating-prefixes[=type]"
.PD 0
.IP "\fB\-\-fake\-by\-branching\-counts\fR" 4
.IX Item "--fake-by-branching-counts"
.IP "\fB\-\-fake\-by\-dirichlet\fR" 4
.IX Item "--fake-by-dirichlet"
.IP "\fB\-\-remap\-prefixes\fR \fIarg\fR" 4
.IX Item "--remap-prefixes arg"
.PD
.SS "Actions"
.IX Subsection "Actions"
Action options calculate a statistic from an aggregate file and output that
statistic.  Each \fBipaggmanip\fR run can contain at most one action.  Unless
otherwise noted, statistics containing multiple numbers are output on one
line, separated by spaces.
.IP "\fB\-\-num\-labels\fR, \fB\-n\fR" 4
.IX Item "--num-labels, -n"
Output the number of labels.
.IP "\fB\-\-num\-in\-prefixes\fR" 4
.IX Item "--num-in-prefixes"
Output the number of active \fIp\fR\-aggregates for each \fIp\fR, 0<=\fIp\fR<=32.
The result is 33 space-separated numbers; the first is the number of active
0\-aggregates, the last the number of active 32\-aggregates (that is, the
number of labels).  The \fIp\fRth number is at most 2^\fIp\fR.
.IP "\fB\-\-num\-in\-left\-prefixes\fR" 4
.IX Item "--num-in-left-prefixes"
Output the number of active left-hand \fIp\fR\-aggregates for each \fIp\fR,
0<=\fIp\fR<=32.  A left-hand \fIp\fR\-aggregate has its lowest-order bit equal to
0.  Consider label 6, which identifies a 32\-aggregate and a 31\-aggregate.
(It does not identify a 30\-aggregate or above.)  Label 6 is a left-hand
32\-aggregate, since bit 31 is 0, but it is \fIright\fR\-hand 31\-aggregate,
since bit 30 is 1.  As a special case, the single 0\-aggregate is considered
left-hand.  The result is 33 space-separated numbers, as in
\&\fB\-\-num\-in\-prefixes\fR.
.IP "\fB\-\-discriminating\-prefix\-counts\fR" 4
.IX Item "--discriminating-prefix-counts"
Output the number of labels that have discriminating prefix \fIp\fR for each
\&\fIp\fR, 0<=\fIp\fR<=32.  The discriminating prefix for a label \fIL\fR is the
smallest \fIp\fR so that the \fIp\fR\-aggregate containing \fIL\fR contains no other
label.  The result is 33 space-separated numbers whose sum will equal
\&\fB\-\-num\-labels\fR.
.IP "\fB\-\-all\-discriminating\-prefix\-counts\fR" 4
.IX Item "--all-discriminating-prefix-counts"
The output is 33 lines, numbered 0 through 32.  Line number \fIp\fR equals the
result of `\fB\-\-prefix\fR \fIp\fR \fB\-\-discriminating\-prefix\-counts\fR' for the
input data: that is, the discriminating prefixes for the data's
\&\fIp\fR\-aggregates.  The discriminating prefix for a \fIp\fR\-aggregate must be
less than or equal to \fIp\fR, so line \fIp\fR contains \fIp\fR+1 space-separated
numbers.
.IP "\fB\-\-counts\fR" 4
.IX Item "--counts"
Output the count for each active label, sorted in label order.  The result
is \fB\-\-num\-labels\fR space-separated numbers.
.IP "\fB\-\-sorted\-counts\fR" 4
.IX Item "--sorted-counts"
Output the count for each active label, sorted in descending order by
count.  The result is \fB\-\-num\-labels\fR space-separated numbers.
.IP "\fB\-\-count\-counts\fR" 4
.IX Item "--count-counts"
For each count \fIc\fR, calculate \fIn\fR, the number of labels that have count
\&\fIc\fR.  Output a series of lines containing "\fIc\fR \fIn\fR", sorted in ascending
order by \fIc\fR.
.IP "\fB\-\-container\-counts\fR \fIp\fR" 4
.IX Item "--container-counts p"
Calculate the number of packets in each label's containing \fIp\fR\-aggregate.
Output each active label's value, sorted in label order.  The result is
\&\fB\-\-num\-labels\fR space-separated numbers.
.IP "\fB\-\-balance\fR \fIp\fR" 4
.IX Item "--balance p"
.PD 0
.IP "\fB\-\-average\-and\-variance\fR" 4
.IX Item "--average-and-variance"
.IP "\fB\-\-average\-and\-variance\-by\-prefix\fR" 4
.IX Item "--average-and-variance-by-prefix"
.IP "\fB\-\-haar\-wavelet\-energy\fR" 4
.IX Item "--haar-wavelet-energy"
.IP "\fB\-\-balance\fR \fIn\fR" 4
.IX Item "--balance n"
.IP "\fB\-\-balance\-histogram\fR \fIn\fR,\fInbuckets\fR" 4
.IX Item "--balance-histogram n,nbuckets"
.IP "\fB\-\-branching\-counts\fR \fIp\fR,\fIstep\fR" 4
.IX Item "--branching-counts p,step"
.IP "\fB\-\-all\-branching\-counts\fR \fIstep\fR" 4
.IX Item "--all-branching-counts step"
.IP "\fB\-\-conditional\-split\-counts\fR \fIp\fR" 4
.IX Item "--conditional-split-counts p"
.IP "\fB\-\-correlation\-size\-container\-addresses\fR \fIp\fR" 4
.IX Item "--correlation-size-container-addresses p"
.PD
.SS "Multiple files"
.IX Subsection "Multiple files"
.IP "\fB\-\-each\fR, \fB\-e\fR" 4
.IX Item "--each, -e"
.PD 0
.IP "\fB\-\-or\fR, \fB\-|\fR" 4
.IX Item "--or, -|"
.IP "\fB\-\-and\fR, \fB\-&\fR" 4
.IX Item "--and, -&"
.IP "\fB\-\-minus\fR" 4
.IX Item "--minus"
.IP "\fB\-\-xor\fR, \fB\-^\fR" 4
.IX Item "--xor, -^"
.IP "\fB\-\-and\-list\fR" 4
.IX Item "--and-list"
.IP "\fB\-\-assign\-counts\fR" 4
.IX Item "--assign-counts"
.PD
.SS "Other options"
.IX Subsection "Other options"
.IP "\fB\-\-read\fR \fIfile\fR, \fB\-r\fR \fIfile\fR" 4
.IX Item "--read file, -r file"
.PD 0
.IP "\fB\-\-output\fR \fIfile\fR, \fB\-o\fR \fIfile\fR" 4
.IX Item "--output file, -o file"
.IP "\fB\-\-binary\fR, \fB\-b\fR" 4
.IX Item "--binary, -b"
.IP "\fB\-\-text\fR" 4
.IX Item "--text"
.IP "\fB\-\-ip\fR" 4
.IX Item "--ip"
.IP "\fB\-\-help\fR, \fB\-h\fR" 4
.IX Item "--help, -h"
.PD
Print a help message to the standard output, then exit.
.IP "\fB\-\-version\fR, \fB\-v\fR" 4
.IX Item "--version, -v"
Print version number and license information to the standard output, then
exit.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIipaggcreate\fR\|(1), \fItcpdump\fR\|(1), \fItcpdpriv\fR\|(1), \fIclick\fR\|(1), \fIipsumdump\fR\|(1)
.PP
See http://www.pdos.csail.mit.edu/click/ for more on Click.
.SH "AUTHOR"
.IX Header "AUTHOR"
Eddie Kohler <kohler@cs.ucla.edu>, based on the Click modular router.
